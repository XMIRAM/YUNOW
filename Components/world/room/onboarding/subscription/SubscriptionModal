import React, { useState } from 'react';
import { motion, AnimatePresence } from 'framer-motion';
import { X, Check, Zap, Crown, Sparkles, Building } from 'lucide-react';

const PLANS = [
  {
    id: 'free',
    name: 'Explorer',
    price: 'Free',
    icon: Zap,
    color: 'from-gray-600 to-gray-700',
    features: [
      'Access all public rooms',
      '50 daily fuel',
      'Basic avatar',
      'Limited room creation',
    ],
    cta: 'Current Plan',
    disabled: true,
  },
  {
    id: 'pro',
    name: 'Pro Citizen',
    price: '$4.99/mo',
    icon: Crown,
    color: 'from-violet-600 to-purple-700',
    popular: true,
    features: [
      'Everything in Explorer',
      '200 daily fuel',
      'Create unlimited rooms',
      'Access archive & museum',
      'Premium frames & auras',
      'Exclusive emotes',
    ],
    cta: 'Upgrade to Pro',
  },
  {
    id: 'creator',
    name: 'Creator',
    price: '$9.99/mo',
    icon: Building,
    color: 'from-amber-500 to-orange-600',
    features: [
      'Everything in Pro',
      '500 daily fuel',
      'Own a Club room',
      'Moderation tools',
      'Seasonal creator passes',
      'Revenue sharing (coming)',
    ],
    cta: 'Go Creator',
  },
];

export default function SubscriptionModal({ isOpen, onClose, currentPlan = 'free' }) {
  const [selectedPlan, setSelectedPlan] = useState(null);

  if (!isOpen) return null;

  return (
    <AnimatePresence>
      <motion.div 
        className="fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-end sm:items-center justify-center"
        initial={{ opacity: 0 }}
        animate={{ opacity: 1 }}
        exit={{ opacity: 0 }}
        onClick={onClose}
      >
        <motion.div 
          className="bg-gray-900 rounded-t-3xl sm:rounded-3xl w-full max-w-lg max-h-[90vh] overflow-y-auto"
          initial={{ y: 100, opacity: 0 }}
          animate={{ y: 0, opacity: 1 }}
          exit={{ y: 100, opacity: 0 }}
          onClick={(e) => e.stopPropagation()}
        >
          {/* Header */}
          <div className="sticky top-0 bg-gray-900 p-4 border-b border-gray-800 flex items-center justify-between">
            <div className="flex items-center gap-3">
              <Sparkles className="w-6 h-6 text-violet-400" />
              <h2 className="text-white font-bold text-lg">Power Up</h2>
            </div>
            <motion.button
              className="w-10 h-10 bg-gray-800 rounded-full flex items-center justify-center"
              whileTap={{ scale: 0.9 }}
              onClick={onClose}
            >
              <X className="w-5 h-5 text-gray-400" />
            </motion.button>
          </div>

          {/* Plans */}
          <div className="p-4 space-y-4">
            {PLANS.map((plan) => {
              const Icon = plan.icon;
              const isCurrent = currentPlan === plan.id;
              
              return (
                <motion.div
                  key={plan.id}
                  className={`
                    relative p-5 rounded-2xl border-2 transition-all
                    ${plan.popular ? 'border-violet-500' : 'border-gray-700'}
                    ${isCurrent ? 'bg-gray-800/50' : 'bg-gray-800/30'}
                  `}
                  whileHover={{ scale: 1.01 }}
                >
                  {plan.popular && (
                    <div className="absolute -top-3 left-1/2 -translate-x-1/2 px-3 py-1 
                                    bg-violet-500 rounded-full text-xs font-bold text-white">
                      MOST POPULAR
                    </div>
                  )}

                  <div className="flex items-start gap-4">
                    <div className={`
                      w-12 h-12 rounded-xl bg-gradient-to-br ${plan.color}
                      flex items-center justify-center
                    `}>
                      <Icon className="w-6 h-6 text-white" />
                    </div>
                    
                    <div className="flex-1">
                      <div className="flex items-center justify-between">
                        <h3 className="text-white font-bold text-lg">{plan.name}</h3>
                        <span className="text-white font-bold">{plan.price}</span>
                      </div>
                      
                      <ul className="mt-3 space-y-2">
                        {plan.features.map((feature, i) => (
                          <li key={i} className="flex items-center gap-2 text-gray-400 text-sm">
                            <Check className="w-4 h-4 text-green-400 flex-shrink-0" />
                            {feature}
                          </li>
                        ))}
                      </ul>
                      
                      <motion.button
                        className={`
                          w-full mt-4 py-3 rounded-xl font-bold text-sm
                          ${plan.disabled || isCurrent
                            ? 'bg-gray-700 text-gray-500 cursor-not-allowed'
                            : `bg-gradient-to-r ${plan.color} text-white`
                          }
                        `}
                        whileHover={!plan.disabled && !isCurrent ? { scale: 1.02 } : {}}
                        whileTap={!plan.disabled && !isCurrent ? { scale: 0.98 } : {}}
                        disabled={plan.disabled || isCurrent}
                      >
                        {isCurrent ? 'Current Plan' : plan.cta}
                      </motion.button>
                    </div>
                  </div>
                </motion.div>
              );
            })}
          </div>

          {/* Footer */}
          <div className="p-4 border-t border-gray-800">
            <p className="text-gray-500 text-xs text-center">
              Cancel anytime. No commitment required.
            </p>
          </div>
        </motion.div>
      </motion.div>
    </AnimatePresence>
  );
}
